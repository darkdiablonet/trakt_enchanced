@import "tailwindcss";

/* Dossiers que Tailwind doit scanner (HTML + JS) */
@source "./public/**/*.html";
@source "./public/**/*.js";
@source "./lib/**/*.js";
@source "./server.js";

/* Safelist des classes uniquement togglées en JS (une seule ligne !) */
@source inline("hidden max-w-7xl mx-auto w-full max-w-none tab-btn-active text-amber-200 border-amber-400/50");

/* tes styles custom dans la couche components */
@layer components {
  :root{ --card-w:220px; }
  
  /* ==== THÈME SOMBRE (par défaut) ==== */
  html, body { min-height: 100%; background-color:#020617; }
  html {
    background:
      radial-gradient(75% 120% at 10% 10%, #0f172a 0%, #020617 60%) fixed no-repeat;
    background-size: cover;
  }
  
  /* Variables CSS pour thème sombre */
  .theme-dark {
    --bg-primary: #020617;
    --bg-secondary: #0f172a;
    --bg-card: linear-gradient(180deg,rgba(15,23,42,.55),rgba(2,6,23,.55));
    --bg-glass: linear-gradient(180deg,rgba(15,23,42,.7),rgba(2,6,23,.7));
    --bg-glass-solid: linear-gradient(180deg,rgba(15, 23, 42, .9),rgba(2, 6, 23, .9));
    --border-primary: #0b2942;
    --border-secondary: rgba(255,255,255,.08);
    --text-primary: #e2e8f0;
    --text-secondary: #cbd5e1;
    --text-muted: #94a3b8;
    --text-disabled: #64748b;
    --accent-primary: #0ea5e9;
    --accent-secondary: #8ab4f8;
    --chip-bg: #0b1220;
    --poster-bg: #0b1220;
  }
  
  /* Variables CSS pour thème clair */
  .theme-light {
    --bg-primary: #f1f5f9;
    --bg-secondary: #e2e8f0;
    --bg-card: linear-gradient(180deg,rgba(255,255,255,.95),rgba(248,250,252,.95));
    --bg-glass: linear-gradient(180deg,rgba(248,250,252,.85),rgba(241,245,249,.85));
    --bg-glass-solid: linear-gradient(180deg,rgba(248,250,252,.95),rgba(241,245,249,.95));
    --border-primary: #cbd5e1;
    --border-secondary: rgba(0,0,0,.12);
    --text-primary: #1e293b;
    --text-secondary: #334155;
    --text-muted: #475569;
    --text-disabled: #64748b;
    --accent-primary: #0ea5e9;
    --accent-secondary: #3b82f6;
    --chip-bg: #e2e8f0;
    --poster-bg: #cbd5e1;
  }
  
  /* Styles adaptatifs selon le thème */
  html.theme-light, html.theme-light body {
    background-color: var(--bg-primary);
    color: var(--text-primary);
  }
  html.theme-light {
    background: radial-gradient(75% 120% at 10% 10%, #e2e8f0 0%, #f1f5f9 60%) fixed no-repeat;
    background-size: cover;
  }
  .hidden{ display:none; }
  .glass{ background: var(--bg-glass); backdrop-filter:blur(8px); }
  .glassNoTrans{ background: var(--bg-glass-solid); backdrop-filter:blur(8px); }
  .btn{ display:inline-flex; align-items:center; gap:.5rem; padding:.45rem .8rem; border-radius:.75rem; background: var(--accent-primary); color:#fff; font-weight:600; }
  .btn-outline{ background:transparent; border:1px solid var(--border-primary); color: var(--text-primary); }
  .chip{ display:inline-flex; align-items:center; gap:.35rem; padding:.2rem .5rem; border-radius:999px; background: var(--chip-bg); border:1px solid var(--border-primary); color: var(--accent-secondary); font-size:.75rem; }
  .poster{ width:100%; padding-top:150%; border-radius:.75rem; background-size:cover; background-position:center; background-color: var(--poster-bg); border:1px solid var(--border-primary); }
  .card{ background: var(--bg-card); border:1px solid var(--border-primary); border-radius:1rem; color: var(--text-primary); }
  .grid-default{ display:grid; grid-template-columns:repeat(auto-fill, minmax(var(--card-w), 1fr)); gap:1rem; }
  .app-header{ position:sticky; top:0; z-index:20; border-bottom:1px solid var(--border-secondary); background: var(--bg-glass); backdrop-filter:blur(6px); }
  .filters{ position:sticky; top:68px; z-index:10; }
  .tabs-group{ display:inline-flex; flex-wrap:wrap; gap:.25rem; padding:.25rem; border-radius:12px; border:1px solid var(--border-secondary); background: var(--bg-glass); }
  .tabs-group button{ padding:.5rem 1rem; border-radius:8px; font-weight:600; font-size:.9rem; color: var(--text-secondary); }
  .tabs-group button:hover{ color: var(--text-primary); }
  .tab-btn-active{ background: var(--accent-primary); color:#fff !important; }
  /* --- Uniquement pour "À voir" --- */
  .poster-wrap{ position:relative; }
  .badge-next{
    position:absolute; top:.5rem; right:.5rem;
    display:inline-flex; align-items:center; gap:.35rem;
    padding:.25rem .5rem; border-radius:.6rem;
    background: var(--accent-primary); color:#06121f; font-weight:700; font-size:.75rem;
    box-shadow:0 6px 18px rgba(14,165,233,.25);
    border:1px solid rgba(255,255,255,.15);
  }
  .chips{ display:flex; flex-wrap:wrap; gap:.4rem; }
  .chip--warn{ border-color:rgba(251,191,36,.5); color:#fde68a; background:rgba(2,6,23,.65); }
  .poster-wrap{ position:relative; }
  .ov-btn{
    position:absolute; right:.5rem; bottom:.5rem;
    display:inline-flex; align-items:center; gap:.35rem;
    padding:.25rem .5rem; border-radius:.5rem;
    background: var(--bg-glass-solid); border:1px solid var(--border-primary); color: var(--text-primary);
  }
  .ov-btn:hover{ background: var(--bg-glass-solid); opacity: 0.9; }
  /* Popover ancré */
  #ovBackdrop { background: transparent; }
  .ov-panel{
    position: fixed;        /* ancré au viewport */
    max-width: 420px;
    width: min(92vw, 420px);
    color: var(--text-primary);
    /* la "glass" existe déjà chez toi */
  }
  .ov-panel .ov-arrow{
    position: absolute;
    width: 12px; height: 12px;
    transform: rotate(45deg);
    background: var(--bg-glass-solid);
    border-left: 1px solid var(--border-primary);
    border-top: 1px solid var(--border-primary);
    /* left est fixé en JS */
  }
  .ov-panel.ov-at-bottom .ov-arrow{ top: -6px; }
  .ov-panel.ov-at-top    .ov-arrow{ bottom: -6px; }
  .topcard{background:linear-gradient(180deg,rgba(15,23,42,.4),rgba(2,6,23,.4));border:1px solid #0b2942;border-radius:.75rem;padding:.5rem}
  .toplist{display:flex;flex-direction:column;gap:.25rem}
  .toplist .row{display:grid;grid-template-columns:1.75rem 1fr auto;align-items:center;gap:.5rem;padding:.45rem .5rem;border-radius:.6rem}
  .toplist .row:hover{background:rgba(14,165,233,.08)}
  .toplist .rank{display:flex;align-items:center;justify-content:center;width:1.5rem;height:1.5rem;border-radius:999px;background:#0b1220;border:1px solid #0b2942;color:#8ab4f8;font-size:.75rem;font-weight:700}
  .toplist .name{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .toplist .bar{margin-top:.25rem;width:100%;height:6px;background:#0f172a;border:1px solid #0b2942;border-radius:999px;overflow:hidden}
  .toplist .bar>span{display:block;height:100%;background:#22c55e;width:var(--w,0%)}
  .chip-xs{font-size:.7rem;padding:.15rem .45rem}
  
  /* Theme Selector */
  .theme-selector{ position:relative; }
  .theme-selector button:hover{ background-color: rgba(255,255,255,.05); }
  .theme-selector .dropdown-active{ background-color: rgba(14,165,233,.1); }
  
  /* Classes de texte adaptatives */
  .text-muted { color: var(--text-muted) !important; }
  .text-secondary { color: var(--text-secondary) !important; }
  .text-disabled { color: var(--text-disabled) !important; }
  .text-adaptive { color: var(--text-primary) !important; }
  
  /* Responsive mobile header */
  @media (max-width: 768px) {
    .app-header .mx-auto {
      flex-direction: column;
      align-items: stretch;
      gap: 1rem;
      padding: 1rem;
    }
    
    .app-header .text-lg {
      font-size: 1rem;
      justify-content: center;
    }
    
    .app-header .ml-auto {
      margin-left: 0;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.5rem;
    }
    
    .theme-selector {
      grid-column: 1 / -1;
      order: -1;
    }
    
    .theme-selector .btn {
      width: 100%;
      justify-content: center;
    }
    
    .app-header form,
    .app-header #toggleWidth,
    .app-header #openFullModal {
      width: 100%;
    }
    
    .app-header .btn {
      width: 100%;
      justify-content: center;
      min-height: 44px;
    }
  }
  
  @media (max-width: 480px) {
    .app-header .ml-auto {
      grid-template-columns: 1fr;
    }
  }
  
  /* Transitions douces pour les changements de thème */
  *, *::before, *::after {
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
  }
}

/* (facultatif) petit fallback pour line-clamp si tu l’utilises */
.line-clamp-2{
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
